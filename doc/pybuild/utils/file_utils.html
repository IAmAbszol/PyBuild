<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>pybuild.utils.file_utils API documentation</title>
<meta name="description" content="File system utilities for PyBuild â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pybuild.utils.file_utils</code></h1>
</header>
<section id="section-intro">
<p>File system utilities for PyBuild.</p>
<p>This class provides a general interface for various file related operations that a user may experience while using PyBuild.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;File system utilities for PyBuild.

    This class provides a general interface for various file related operations that a user may experience while using PyBuild.

&#34;&#34;&#34;
import re
import shutil

from pathlib import Path
from tempfile import NamedTemporaryFile

from pybuild.utils import os_utils


def copy(src, dst, *args):
    &#34;&#34;&#34;Copy files and directories in PyBuild.
    
    Some builds require the copying and movement of files around the system.
    &#34;&#34;&#34;
    return shutil.copy2(src, dst, args)


def move(src, dst):
    &#34;&#34;&#34;Move files and directories in PyBuild.
    
    Some builds require the moving of files around the system.
    &#34;&#34;&#34;
    return shutil.move(src, dst)


def process_requirements(requirements : Path) -&gt; bool:
    &#34;&#34;&#34;Processes a requirements.txt or any named variant that came off of pip.freeze.

    Certain environments have packages installed as editable which cause uninstallation related issues
    when wiping the environment using Environment.wipe. To circumvent this, processing the requirements.txt or
    any named variant that removes the editable comment and following line will fix this issue.

    Returns:
        True if the process completed successfully else False.

    Raises:
        FileNotFoundError: When requirements wasn&#39;t able to be found.
        Additional errors raised by shutil.
    &#34;&#34;&#34;
    if requirements.exists():
        with open(requirements, &#39;r&#39;) as fd:
            with NamedTemporaryFile(delete=False) as tmpfd:
                index, lines = 0, fd.readlines()
                while index &lt; len(lines):
                    line = lines[index]
                    if not &#39;# Editable install&#39; in line:
                        tmpfd.write(bytes(line, encoding=&#39;utf-8&#39;))
                    else:
                        index += 1
                    index += 1
                tmpfd.flush()
                shutil.copyfile(tmpfd.name, requirements)
                tmpfd.close()
                os_utils.remove_file(Path(tmpfd.name))
                return True
    else:
        raise FileNotFoundError(f&#39;Unable to find requirements, path provided {str(requirements)}.&#39;)


def validate_url(url):
    
    # URL regex validation from Django
    # https://stackoverflow.com/questions/7160737/how-to-validate-a-url-in-python-malformed-or-not
    url_regex = re.compile(
        r&#39;^(?:http|ftp)s?://&#39; # http:// or https://
        r&#39;(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\.)+(?:[A-Z]{2,6}\.?|[A-Z0-9-]{2,}\.?)|&#39; #domain...
        r&#39;localhost|&#39; #localhost...
        r&#39;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})&#39; # ...or ip
        r&#39;(?::\d+)?&#39; # optional port
        r&#39;(?:/?|[/?]\S+)$&#39;, re.IGNORECASE)
    return re.match(url_regex, url) is not None</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pybuild.utils.file_utils.copy"><code class="name flex">
<span>def <span class="ident">copy</span></span>(<span>src, dst, *args)</span>
</code></dt>
<dd>
<div class="desc"><p>Copy files and directories in PyBuild.</p>
<p>Some builds require the copying and movement of files around the system.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def copy(src, dst, *args):
    &#34;&#34;&#34;Copy files and directories in PyBuild.
    
    Some builds require the copying and movement of files around the system.
    &#34;&#34;&#34;
    return shutil.copy2(src, dst, args)</code></pre>
</details>
</dd>
<dt id="pybuild.utils.file_utils.move"><code class="name flex">
<span>def <span class="ident">move</span></span>(<span>src, dst)</span>
</code></dt>
<dd>
<div class="desc"><p>Move files and directories in PyBuild.</p>
<p>Some builds require the moving of files around the system.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def move(src, dst):
    &#34;&#34;&#34;Move files and directories in PyBuild.
    
    Some builds require the moving of files around the system.
    &#34;&#34;&#34;
    return shutil.move(src, dst)</code></pre>
</details>
</dd>
<dt id="pybuild.utils.file_utils.process_requirements"><code class="name flex">
<span>def <span class="ident">process_requirements</span></span>(<span>requirements:Â pathlib.Path) â€‘>Â bool</span>
</code></dt>
<dd>
<div class="desc"><p>Processes a requirements.txt or any named variant that came off of pip.freeze.</p>
<p>Certain environments have packages installed as editable which cause uninstallation related issues
when wiping the environment using Environment.wipe. To circumvent this, processing the requirements.txt or
any named variant that removes the editable comment and following line will fix this issue.</p>
<h2 id="returns">Returns</h2>
<p>True if the process completed successfully else False.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>FileNotFoundError</code></dt>
<dd>When requirements wasn't able to be found.</dd>
</dl>
<p>Additional errors raised by shutil.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def process_requirements(requirements : Path) -&gt; bool:
    &#34;&#34;&#34;Processes a requirements.txt or any named variant that came off of pip.freeze.

    Certain environments have packages installed as editable which cause uninstallation related issues
    when wiping the environment using Environment.wipe. To circumvent this, processing the requirements.txt or
    any named variant that removes the editable comment and following line will fix this issue.

    Returns:
        True if the process completed successfully else False.

    Raises:
        FileNotFoundError: When requirements wasn&#39;t able to be found.
        Additional errors raised by shutil.
    &#34;&#34;&#34;
    if requirements.exists():
        with open(requirements, &#39;r&#39;) as fd:
            with NamedTemporaryFile(delete=False) as tmpfd:
                index, lines = 0, fd.readlines()
                while index &lt; len(lines):
                    line = lines[index]
                    if not &#39;# Editable install&#39; in line:
                        tmpfd.write(bytes(line, encoding=&#39;utf-8&#39;))
                    else:
                        index += 1
                    index += 1
                tmpfd.flush()
                shutil.copyfile(tmpfd.name, requirements)
                tmpfd.close()
                os_utils.remove_file(Path(tmpfd.name))
                return True
    else:
        raise FileNotFoundError(f&#39;Unable to find requirements, path provided {str(requirements)}.&#39;)</code></pre>
</details>
</dd>
<dt id="pybuild.utils.file_utils.validate_url"><code class="name flex">
<span>def <span class="ident">validate_url</span></span>(<span>url)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def validate_url(url):
    
    # URL regex validation from Django
    # https://stackoverflow.com/questions/7160737/how-to-validate-a-url-in-python-malformed-or-not
    url_regex = re.compile(
        r&#39;^(?:http|ftp)s?://&#39; # http:// or https://
        r&#39;(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\.)+(?:[A-Z]{2,6}\.?|[A-Z0-9-]{2,}\.?)|&#39; #domain...
        r&#39;localhost|&#39; #localhost...
        r&#39;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})&#39; # ...or ip
        r&#39;(?::\d+)?&#39; # optional port
        r&#39;(?:/?|[/?]\S+)$&#39;, re.IGNORECASE)
    return re.match(url_regex, url) is not None</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pybuild.utils" href="index.html">pybuild.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="pybuild.utils.file_utils.copy" href="#pybuild.utils.file_utils.copy">copy</a></code></li>
<li><code><a title="pybuild.utils.file_utils.move" href="#pybuild.utils.file_utils.move">move</a></code></li>
<li><code><a title="pybuild.utils.file_utils.process_requirements" href="#pybuild.utils.file_utils.process_requirements">process_requirements</a></code></li>
<li><code><a title="pybuild.utils.file_utils.validate_url" href="#pybuild.utils.file_utils.validate_url">validate_url</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>